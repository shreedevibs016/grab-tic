{% extends 'base.html' %}

{% block main%}

  <main class="main">

 <section id="hero" class="hero section dark-background">

      <img src="/static/assets/img/hero-bg.jpg" alt="" data-aos="fade-in">

      <div class="container d-flex flex-column align-items-center">
        
                 <div class="col-lg-6">
                    <h3 class="my-4">Verify OTP</h3>
                    <p>An otp send to {{ phone }}</p>
            <form action="" method="post" data-aos="fade-up" data-aos-delay="500">
              {% csrf_token %}
              <div class="row gy-4">

                <div class="col-md-10">
                  <!-- <input type="text" name="name" class="form-control" placeholder="Movie Name" required=""> -->
                   {{ form.otp }}
                   {% if form.otp.errors %}
                   <p class="small text-danger" style="font-size: 15px;">{{ form.otp.errors.0 }}</p>
                   {% endif %}
                </div>

                <div class="col-md-12 text-center">
                  <button type="submit" style="color: #fff; background-color: #ff4a17; border: 0px; padding: 10px 30px; transition: 0.4s; border-radius: 50px;">verify</button>
                </div>

                <div class="col-md-12 text-center ">

                   {% if error %}
                   <p class="small text-danger" style="font-size: 15px;">{{ error }}</p>
                   {% endif %}
                </div>

              </div>
            </form>
            <p class="text-center text-danger small" id="timer"></p>
          </div><!-- End Contact Form -->
      </div>

    </section>

  </main>
  <script>
    let timeLeft = parseInt('{{ remaining_time|default:0 }}');
    let timerElement = document.getElementById('timer');

    function updateTimer() {
        if (timeLeft <= 0) {
            timerElement.innerHTML = `
            <a class="btn btn-primary mt-3" href='{% url 'phone-otp' %}'>Resend OTP</a>
                `;
        } else {
            let minutes = Math.floor(timeLeft / 60);
            let seconds = timeLeft % 60;
            timerElement.innerText = `Time left: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            timeLeft--;
            setTimeout(updateTimer, 1000);
        }
    }

    updateTimer();
</script>

{% endblock %}  